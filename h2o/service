[Unit]
After=network.target network-online.target nss-lookup.target
Description=Optimized HTTP server with support for HTTP/1.x and HTTP/2

[Service]
AmbientCapabilities=CAP_NET_BIND_SERVICE
KillMode=mixed
LimitNOFILE=infinity
PIDFile=/run/h2o/h2o.pid
Restart=on-failure
Type=forking
User=http

LogsDirectory=h2o
RuntimeDirectory=h2o

ExecStartPre=/usr/bin/h2o -t
ExecStart=/usr/bin/h2o -m daemon
ExecReload=/usr/bin/kill -HUP $MAINPID
ExecStop=/usr/bin/kill $MAINPID

PrivateDevices=true
PrivateTmp=true
ProtectControlGroups=true
ProtectHome=true
ProtectKernelModules=true
ProtectKernelTunables=true
ProtectSystem=strict

[Install]
WantedBy=multi-user.target
